<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>IOCL</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
  </head>
  <body>
    <nav class="navbar navbar-expand-lg fixed-top navbar-dark bg-primary">
      <div class="container-fluid">
        <a class="navbar-brand" href="/">IOCL SRPL TLR</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="/">Statements</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/generateExcelPage">Generate Excel</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/config">Configuration</a>
            </li>
          </ul>
          <ul class="navbar-nav navbar-right">
            <li class="nav-item navbar-right">
              <a class="nav-link" href="/logout">Logout üö™</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container-fluid bg-light">
      <div class="container mt-5 pt-5 pb-5">

        <h1 class="text-center">STATEMENT OF SRPL PROJECTS - IOCL, THIRUVALLUR üìù</h1>

        <div class="row mt-5">
          <h4 class="col">Total Records Count: {{ total_records_count }}</h4>
            <button class="col-3 btn btn-outline-primary" type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample" aria-expanded="{{aria}}" aria-controls="collapseExample">
              Add Record
            </button>
        </div>
        {% if aria %}
        <div class="collapse mt-3 col-lg-6 mx-auto show" id="collapseExample">
          {% else %}
          <div class="collapse mt-3 col-lg-6 mx-auto" id="collapseExample">
            {% endif %}
            <div class="card card-body">
                <h4>Add Record</h4>
                <form action="{{ url_for('addRecord') }}" method="POST">
                    <div class="mb-3">
                      <label for="projectName" class="form-label">Project</label>
                      <select class="form-select" id="projectName" name="projectID" required>
                        {%for i in range(0, projects_count)%}
                          {% if addProjectID == projects_output[i].projectID %}
                            <option value="{{projects_output[i].projectID}}" selected>{{projects_output[i].projectName}}</option>
                          {% else %}
                            <option value="{{projects_output[i].projectID}}">{{projects_output[i].projectName}}</option>
                          {% endif %}
                        {%endfor%}
                      </select>
                    </div>
                    <div class="mb-3">
                      <label for="transactionType" class="form-label">DEPOSIT / DISBURSAL</label>
                      <div class="form-check">
                        {% if addTransactionType == 'DEPOSIT' %}
                          <input class="form-check-input transactionTypeInput" type="radio" name="transactionType" id="flexRadioDefault3" checked value="DEPOSIT">
                        {% else %}
                          <input class="form-check-input transactionTypeInput" type="radio" name="transactionType" id="flexRadioDefault3" value="DEPOSIT">
                        {% endif %}
                        <label class="form-check-label" for="flexRadioDefault3">
                          DEPOSIT
                        </label>
                      </div>
                      <div class="form-check">
                        {% if addTransactionType == 'DISBURSAL' %}
                          <input class="form-check-input transactionTypeInput" type="radio" name="transactionType" id="flexRadioDefault4" checked value="DISBURSAL">
                        {% else %}
                          <input class="form-check-input transactionTypeInput" type="radio" name="transactionType" id="flexRadioDefault4" value="DISBURSAL">
                        {% endif %}
                        <label class="form-check-label" for="flexRadioDefault4">
                          DISBURSAL
                        </label>
                      </div>
                    </div>
                    <div class="mb-3">
                      <label for="date" class="form-label">Date</label>
                      {% if addDate %}
                        <input type="date" class="form-control" id="date" name="date" value="{{addDate}}" required/>
                      {% else %}
                        <input type="date" class="form-control" id="date" name="date" required/>
                      {% endif %}
                    </div>
                    <div class="mb-3">
                      <label for="villageName" class="form-label">Village</label>
                      <select class="form-select" id="villageName" name="villageID" required>
                        {%for i in range(0, villages_count)%}
                          {% if addVillageID == villages_output[i].villageID %}
                            <option value="{{villages_output[i].villageID}}" selected>{{villages_output[i].villageName}}</option>
                          {% else %}
                            <option value="{{villages_output[i].villageID}}">{{villages_output[i].villageName}}</option>
                          {% endif %}
                        {%endfor%}
                      </select>
                    </div>
                    {% if addTransactionType == 'DISBURSAL' %}
                    <div class="mb-3" id="landOwnerDiv">
                      {% else %}
                      <div class="mb-3 visually-hidden" id="landOwnerDiv">
                      {% endif %}
                      <label for="landOwner" class="form-label">Name Of The Owner / Cultivator</label>
                      <input type="text" class="form-control" id="landOwner" name="landOwner" />
                    </div>
                    <div class="mb-3">
                      <label for="type" class="form-label">Compensation For</label>
                      <div class="form-check">
                        {% if addType == 'Land' %}
                          <input class="form-check-input" type="radio" name="type" id="flexRadioDefault1" checked value="Land">
                        {% else %}
                          <input class="form-check-input" type="radio" name="type" id="flexRadioDefault1" value="Land">
                        {% endif %}
                        <label class="form-check-label" for="flexRadioDefault1">
                          Land
                        </label>
                      </div>
                      <div class="form-check">
                        {% if addType == 'Crop' %}
                          <input class="form-check-input" type="radio" name="type" id="flexRadioDefault2" checked value="Crop">
                        {% else %}
                          <input class="form-check-input" type="radio" name="type" id="flexRadioDefault2" value="Crop">
                        {% endif %}
                        <label class="form-check-label" for="flexRadioDefault2">
                          Crop
                        </label>
                      </div>
                    </div>
                    {% if addTransactionType == 'DISBURSAL' %}
                    <div class="mb-3" id="chequeNumberDiv">
                      {% else %}
                      <div class="mb-3 visually-hidden" id="chequeNumberDiv">
                        {% endif %}
                      <label for="chequeNumber" class="form-label">Cheque Number</label>
                      {% if isChequeNumberExists == 'N' %}
                      <input type="number" class="form-control" id="chequeNumber" name="chequeNumber" value="{{addChequeNumber}}" />
                      <div id="validationChequeNumberFeedback" class="visually-hidden invalid-feedback">
                        Cheque number already exists.
                      </div>
                      {% else %}
                      <input type="number" class="form-control is-invalid" id="chequeNumber" name="chequeNumber" value="{{addChequeNumber}}" />
                      <div id="validationChequeNumberFeedback" class="invalid-feedback">
                        Cheque number already exists.
                      </div>
                      {% endif %}
                    </div>
                    <div class="mb-3">
                      <label for="amount" class="form-label">Amount</label>
                      <input type="number" class="form-control" id="amount" name="amount" required/>
                    </div>
                    {% if addTransactionType == 'DISBURSAL' %}
                    <div class="mb-3" id="serialNumberDiv">
                      {% else %}
                      <div class="mb-3 visually-hidden" id="serialNumberDiv">
                        {% endif %}
                      <label for="serialNumber" class="form-label">Serial Number In List Of Award</label>
                      <input type="text" class="form-control" id="serialNumber" name="serialNumber" />
                    </div>
                    {% if addTransactionType == 'DISBURSAL' %}
                    <div class="mb-3" id="remarksDiv">
                      {% else %}
                      <div class="mb-3 visually-hidden" id="remarksDiv">
                        {% endif %}
                      <label for="remarks" class="form-label">Date Of Encash / Remarks</label>
                      <input type="text" class="form-control" id="remarks" name="remarks" />
                    </div>
                    <input type="hidden" name="filterProjectID" id="filterProjectID" value="{{projectID}}">
                    <input type="hidden" name="filterVillageID" id="filterVillageID" value="{{villageID}}">
                    <input type="hidden" name="filterType" id="filterType" value="{{type}}">
                    <input type="hidden" name="filterTransactionType" id="filterTransactionType" value="{{transactionType}}">
                    <input type="hidden" name="filterFromDate" id="filterFromDate" value="{{fromDate}}">
                    <input type="hidden" name="filterToDate" id="filterToDate" value="{{toDate}}">
                    <div class="d-grid gap-2">
                      <button type="submit" class="btn btn-primary" type="button">Add</button>
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                      <symbol id="check-circle-fill" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
                      </symbol>
                      <symbol id="info-fill" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/>
                      </symbol>
                      <symbol id="exclamation-triangle-fill" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
                      </symbol>
                    </svg>
                    {% if addAmountAria %}
                    <div class="alert alert-success d-flex align-items-center alert-dismissible fade show mt-2" role="alert">
                      {% else %}
                      <div class="alert alert-success d-flex align-items-center alert-dismissible fade show mt-2 visually-hidden" role="alert">
                        {% endif %}
                      <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Success:"><use xlink:href="#check-circle-fill"/></svg>
                      <div>
                        New record ‚Çπ {{addAmount}} added successfully.
                      </div>
                      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                  </form>
            </div>
          </div>
          <hr>

        {% if total_records_count %}
        <div class="card card-body">
            <form action="{{ url_for('viewStatement') }}" method="POST">
              <div class="row g-2">
                <div class="col-md">
                  <div class="form-floating">
                    <select class="form-select" id="filterProjectName" name="filterProjectID">
                      <option value="ALL">ALL</option>
                      {%for i in range(0, projects_count)%}
                        {% if projectID == projects_output[i].projectID %}
                          <option value="{{projects_output[i].projectID}}" selected>{{projects_output[i].projectName}}</option>
                        {% else %}
                          <option value="{{projects_output[i].projectID}}">{{projects_output[i].projectName}}</option>
                        {% endif %}
                      {%endfor%}
                    </select>
                    <label for="filterProjectName">Project</label>
                  </div>
                </div>
                <div class="col-md">
                  <div class="form-floating">
                    <select class="form-select" id="filterVillageName" name="filterVillageID">
                      <option value="ALL">ALL</option>
                      {% if filter_villages_output %}
                        {%for i in range(0, filter_villages_count)%}
                          {% if villageID == filter_villages_output[i].villageID %}
                            <option value="{{filter_villages_output[i].villageID}}" selected>{{filter_villages_output[i].villageName}}</option>
                          {% else %}
                            <option value="{{filter_villages_output[i].villageID}}">{{filter_villages_output[i].villageName}}</option>
                          {% endif %}
                        {%endfor%}
                      {% endif %}
                    </select>
                    <label for="filterVillageName">Village</label>
                  </div>
                </div>
              </div>
              <div class="row g-2 mt-2">
                <div class="col-md">
                    <label for="transactionType" class="form-label">DEPOSIT / DISBURSAL</label>
                    <div class="form-check">
                      {% if transactionType == 'ALL' %}
                        <input class="form-check-input filterTransactionTypeInput" type="radio" name="filterTransactionType" id="filterTransactionType1" checked value="ALL">
                      {% else %}
                        <input class="form-check-input filterTransactionTypeInput" type="radio" name="filterTransactionType" id="filterTransactionType1" value="ALL">
                      {% endif %}
                      <label class="form-check-label" for="filterTransactionType1">
                        ALL
                      </label>
                    </div>
                    <div class="form-check">
                      {% if transactionType == 'DEPOSIT' %}
                        <input class="form-check-input filterTransactionTypeInput" type="radio" name="filterTransactionType" id="filterTransactionType2" checked value="DEPOSIT">
                      {% else %}
                        <input class="form-check-input filterTransactionTypeInput" type="radio" name="filterTransactionType" id="filterTransactionType2" value="DEPOSIT">
                      {% endif %}
                      <label class="form-check-label" for="filterTransactionType2">
                        DEPOSIT
                      </label>
                    </div>
                    <div class="form-check">
                      {% if transactionType == 'DISBURSAL' %}
                        <input class="form-check-input filterTransactionTypeInput" type="radio" name="filterTransactionType" id="filterTransactionType3" checked value="DISBURSAL">
                      {% else %}
                        <input class="form-check-input filterTransactionTypeInput" type="radio" name="filterTransactionType" id="filterTransactionType3" value="DISBURSAL">
                      {% endif %}
                      <label class="form-check-label" for="filterTransactionType3">
                        DISBURSAL
                      </label>
                    </div>
                </div>
                <div class="col-md">
                  <label for="type" class="form-label">Compensation For</label>
                  <div class="form-check">
                    {% if type == 'ALL' %}
                      <input class="form-check-input filterTypeInput" type="radio" name="filterType" id="filterType1" checked value="ALL">
                    {% else %}
                      <input class="form-check-input filterTypeInput" type="radio" name="filterType" id="filterType1" value="ALL">
                    {% endif %}
                    <label class="form-check-label" for="filterType1">
                      ALL
                    </label>
                  </div>
                  <div class="form-check">
                    {% if type == 'Land' %}
                      <input class="form-check-input filterTypeInput" type="radio" name="filterType" id="filterType2" checked value="Land">
                    {% else %}
                      <input class="form-check-input filterTypeInput" type="radio" name="filterType" id="filterType2" value="Land">
                    {% endif %}
                    <label class="form-check-label" for="filterType2">
                      Land
                    </label>
                  </div>
                  <div class="form-check">
                    {% if type == 'Crop' %}
                      <input class="form-check-input filterTypeInput" type="radio" name="filterType" id="filterType3" checked value="Crop">
                    {% else %}
                      <input class="form-check-input filterTypeInput" type="radio" name="filterType" id="filterType3" value="Crop">
                    {% endif %}
                    <label class="form-check-label" for="filterType3">
                      Crop
                    </label>
                  </div>
              </div>
              </div>
              <div class="row g-2 mt-2">
                <div class="col-md">
                  <div class="form-floating">
                    {% if fromDate %}
                      <input type="date" class="form-control" id="filterFromDate" name="filterFromDate" value="{{fromDate}}"/>
                    {% else %}
                      <input type="date" class="form-control" id="filterFromDate" name="filterFromDate"/>
                    {% endif %}
                    <label for="filterFromDate">From Date</label>
                  </div>
                </div>
                <div class="col-md">
                  <div class="form-floating">
                    {% if toDate %}
                      <input type="date" class="form-control" id="filterToDate" name="filterToDate" value="{{toDate}}"/>
                    {% else %}
                      <input type="date" class="form-control" id="filterToDate" name="filterToDate"/>
                    {% endif %}
                    <label for="filterToDate">To Date</label>
                  </div>
                </div>
              </div>
                <div class="d-grid gap-2 mt-3">
                  <button type="submit" class="btn btn-primary">View Statement</button>
                </div>
              </form>
        </div>
        
        <div class="row mt-3 text-center">
            <h4 class="col-lg"><span class="badge bg-secondary">Records Count: {{ records_count }}</span></h4>
            <h4 class="col-lg"><span class="badge bg-secondary">{{sum_text}}: {{ sum }} ‚Çπ</span></h4>
        </div>

        <div class="table-responsive">
        <table class="table table-striped mt-3">
          <thead>
            <tr>
        <div>
              <th scope="col" class="text-nowrap">Serial Number</th>
              <th scope="col" class="text-nowrap">Project Name</th>
              <th scope="col" class="text-nowrap">DEPOSIT / DISBURSAL</th>
              <th scope="col" class="text-nowrap">Date</th>
              <th scope="col" class="text-nowrap">Village Name</th>
              {% if transactionType != 'DEPOSIT' %}
              <th scope="col" class="text-nowrap">Name Of The Owner / Cultivator</th>
              {% endif %}
              <th scope="col" class="text-nowrap">Compensation For</th>
              {% if transactionType != 'DEPOSIT' %}
              <th scope="col" class="text-nowrap">Cheque Number</th>
              {% endif %}
              <th scope="col" class="text-end text-nowrap">Amount ‚Çπ</th>
              {% if transactionType != 'DEPOSIT' %}
              <th scope="col" class="text-nowrap">Serial Number In List Of Award</th>
              {% endif %}
              {% if transactionType != 'DEPOSIT' %}
              <th scope="col" class="text-nowrap">Date Of Encash / Remarks</th>
              {% endif %}
              <th scope="col" class="text-center text-nowrap">Actions</th>
            </tr>
          </thead>
          <tbody>
            {%for i in range(0, records_count)%}
            <tr>
              <th scope="row" class="text-nowrap">{{i + 1}}</th>
              <td class="text-nowrap">{{records_output[i].project.projectName}}</td>
              <td class="text-nowrap">{{records_output[i].transactionType}}</td>
              <td class="text-nowrap">{{records_output[i].date}}</td>
              <td class="text-nowrap">{{records_output[i].village.villageName}}</td>
              {% if transactionType != 'DEPOSIT' %}
              <td class="text-nowrap">{{records_output[i].landOwner}}</td>
              {% endif %}
              <td class="text-nowrap">{{records_output[i].type}}</td>
              {% if transactionType != 'DEPOSIT' %}
              <td class="text-nowrap">{{records_output[i].chequeNumber}}</td>
              {% endif %}
              <td class="text-end text-nowrap">{{records_output[i].amount}}</td>
              {% if transactionType != 'DEPOSIT' %}
              <td class="text-nowrap">{{records_output[i].serialNumber}}</td>
              {% endif %}
              {% if transactionType != 'DEPOSIT' %}
              <td class="text-nowrap">{{records_output[i].remarks}}</td>
              {% endif %}
              <td class="text-nowrap" style="white-space: nowrap; width: 1px; text-align: right;">
                <button type="action" class="btn btn-primary btn-sm mx-2 edit-record-btn" data-bs-toggle="modal" data-bs-target="#exampleModal1" 
                data-project-id="{{records_output[i].project._id}}" 
                data-village-id="{{records_output[i].village._id}}" 
                data-transaction-type="{{records_output[i].transactionType}}" 
                data-date="{{records_output[i].editDate}}" 
                data-land-owner="{{records_output[i].landOwner}}" 
                data-type="{{records_output[i].type}}" 
                data-cheque-number="{{records_output[i].chequeNumber}}" 
                data-amount="{{records_output[i].intAmount}}" 
                data-serial-number="{{records_output[i].serialNumber}}" 
                data-remarks="{{records_output[i].remarks}}" 
                data-record-id="{{records_output[i].recordID}}">EDIT</button>
                <button type="button" class="btn btn-danger btn-sm delete-record-btn" data-bs-toggle="modal" data-bs-target="#exampleModal2" data-record-id="{{records_output[i].recordID}}">DELETE</button>
              </td>
            </tr>
            {%endfor%}
          </tbody>
        </table>
      </div>
        {% endif %}

        <div class="modal fade" id="exampleModal1" tabindex="-1" aria-labelledby="exampleModalLabel1" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel1">Edit Record</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <form action="{{ url_for('updateRecord') }}" method="POST">
              <div class="modal-body">
                <div class="mb-3">
                  <label for="editProjectName" class="form-label">Project</label>
                  <select class="form-select" id="editProjectName" name="editProjectID">
                    {%for i in range(0, projects_count)%}
                        <option value="{{projects_output[i].projectID}}">{{projects_output[i].projectName}}</option>
                    {%endfor%}
                  </select>
                </div>
                <div class="mb-3">
                  <label for="editTransactionType" class="form-label">DEPOSIT / DISBURSAL</label>
                  <div class="form-check">
                    <input class="form-check-input editTransactionTypeInput" type="radio" name="editTransactionType" id="editTransactionTypeDeposit" value="DEPOSIT">
                    <label class="form-check-label" for="editTransactionTypeDeposit">
                      DEPOSIT
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input editTransactionTypeInput" type="radio" name="editTransactionType" id="editTransactionTypeDisbursal" value="DISBURSAL">
                    <label class="form-check-label" for="editTransactionTypeDisbursal">
                      DISBURSAL
                    </label>
                  </div>
                </div>
                <div class="mb-3">
                  <label for="editDate" class="form-label">Date</label>
                  <input type="date" class="form-control" id="editDate" name="editDate" required/>
                </div>
                <div class="mb-3">
                  <label for="editVillageName" class="form-label">Village</label>
                  <select class="form-select" id="editVillageName" name="editVillageID">
                    {%for i in range(0, villages_count)%}
                        <option value="{{villages_output[i].villageID}}">{{villages_output[i].villageName}}</option>
                    {%endfor%}
                  </select>
                </div>
                <div class="mb-3 visually-hidden" id="editLandOwnerDiv">
                  <label for="editLandOwner" class="form-label">Name Of The Owner / Cultivator</label>
                  <input type="text" class="form-control" id="editLandOwner" name="editLandOwner"/>
                </div>
                <div class="mb-3">
                  <label for="editType" class="form-label">Compensation For</label>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="editType" id="editTypeLand" checked value="Land">
                    <label class="form-check-label" for="editTypeLand">
                      Land
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="editType" id="editTypeCrop" value="Crop">
                    <label class="form-check-label" for="editTypeCrop">
                      Crop
                    </label>
                  </div>
                </div>
                <div class="mb-3 visually-hidden" id="editChequeNumberDiv">
                  <label for="editChequeNumber" class="form-label">Cheque Number</label>
                  <input type="number" class="form-control" id="editChequeNumber" name="editChequeNumber"/>
                </div>
                <div class="mb-3">
                  <label for="editAmount" class="form-label">Amount</label>
                  <input type="number" class="form-control" id="editAmount" name="editAmount" required/>
                </div>
                <div class="mb-3 visually-hidden" id="editSerialNumberDiv">
                  <label for="editSerialNumber" class="form-label">Serial Number In List Of Award</label>
                  <input type="text" class="form-control" id="editSerialNumber" name="editSerialNumber"/>
                </div>
                <div class="mb-3 visually-hidden" id="editRemarksDiv">
                  <label for="editRemarks" class="form-label">Date Of Encash / Remarks</label>
                  <input type="text" class="form-control" id="editRemarks" name="editRemarks"/>
                </div>
                <input type="hidden" name="recordID" id="recordID">
                <input type="hidden" name="filterProjectID" id="filterProjectID" value="{{projectID}}">
                <input type="hidden" name="filterVillageID" id="filterVillageID" value="{{villageID}}">
                <input type="hidden" name="filterType" id="filterType" value="{{type}}">
                <input type="hidden" name="filterTransactionType" id="filterTransactionType" value="{{transactionType}}">
                <input type="hidden" name="filterFromDate" id="filterFromDate" value="{{fromDate}}">
                <input type="hidden" name="filterToDate" id="filterToDate" value="{{toDate}}">
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-primary">Update</button>
              </div>
            </form>
            </div>
          </div>
        </div>
        <p class="visually-hidden" id="hiddenVillageID"></p>

        <div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModalLabel2" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel2">‚ö†Ô∏è Delete Record</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <form action="{{ url_for('deleteRecord') }}" method="POST">
              <div class="modal-body fw-bolder text-uppercase">
                <p id="delete-text">Are you sure you want to delete this record?</p>
              </div>
              <input type="hidden" name="recordID" id="recordID">
              <input type="hidden" name="filterProjectID" id="filterProjectID" value="{{projectID}}">
              <input type="hidden" name="filterVillageID" id="filterVillageID" value="{{villageID}}">
              <input type="hidden" name="filterType" id="filterType" value="{{type}}">
              <input type="hidden" name="filterTransactionType" id="filterTransactionType" value="{{transactionType}}">
              <input type="hidden" name="filterFromDate" id="filterFromDate" value="{{fromDate}}">
              <input type="hidden" name="filterToDate" id="filterToDate" value="{{toDate}}">
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-danger">Delete</button>
              </div>
            </form>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.1.slim.min.js" integrity="sha256-w8CvhFs7iHNVUtnSP0YKEg00p9Ih13rlL9zGqvLdePA=" crossorigin="anonymous"></script>
    <script>
      $('#projectName').on('change', function() {
        var projectID = this.value;
        fetch("/getVillagesOfProject/"+projectID,).then(response => {
          return response.json();
        }).then(data => {
          htmlData = "";
          for (var i = 0; i < data.villages_count; i++) {
            htmlData += "<option value="+data.villages_output[i].villageID+">"+data.villages_output[i].villageName+"</option>";
          }
          $("#villageName").html( htmlData );
        }).catch(err => {
          alert( "Error." );
        });
      });

      $(document).on("click", ".transactionTypeInput", function () {
        var transactionType = this.value;
        if(transactionType == "DEPOSIT") {
          $("#landOwnerDiv").addClass("visually-hidden");
          $("#chequeNumberDiv").addClass("visually-hidden");
          $("#serialNumberDiv").addClass("visually-hidden");
          $("#remarksDiv").addClass("visually-hidden");
          $("#landOwner").val("");
          $("#chequeNumber").val("");
          $("#serialNumber").val("");
          $("#remarks").val("");
        } else {
          $("#landOwnerDiv").removeClass("visually-hidden");
          $("#chequeNumberDiv").removeClass("visually-hidden");
          $("#serialNumberDiv").removeClass("visually-hidden");
          $("#remarksDiv").removeClass("visually-hidden");
        }
      });

      $('#editProjectName').on('change', function() {
        var projectID = this.value;
        fetch("/getVillagesOfProject/"+projectID,).then(response => {
          return response.json();
        }).then(data => {
          htmlData = "";
          for (var i = 0; i < data.villages_count; i++) {
            htmlData += "<option value="+data.villages_output[i].villageID+">"+data.villages_output[i].villageName+"</option>";
          }
          $("#editVillageName").html( htmlData );
          var hiddenVillageID = $("#hiddenVillageID").text()
          if(hiddenVillageID != ""){
            $("#exampleModal1 #editVillageName").val(hiddenVillageID).change();
            $("#hiddenVillageID").text("")
          }
          
        }).catch(err => {
          alert( "Error." );
        });
      });

      $(document).on("click", ".editTransactionTypeInput", function () {
        var transactionType = this.value;
        if(transactionType == "DEPOSIT") {
          $("#editLandOwnerDiv").addClass("visually-hidden");
          $("#editChequeNumberDiv").addClass("visually-hidden");
          $("#editSerialNumberDiv").addClass("visually-hidden");
          $("#editLandOwner").val("");
          $("#editChequeNumber").val("");
          $("#editSerialNumber").val("");
        } else {
          $("#editLandOwnerDiv").removeClass("visually-hidden");
          $("#editChequeNumberDiv").removeClass("visually-hidden");
          $("#editSerialNumberDiv").removeClass("visually-hidden");
        }
      });

      $(document).on("click", ".edit-record-btn", function () {
        var projectID = $(this).data('project-id');
        var villageID = $(this).data('village-id');
        $("#hiddenVillageID").text(villageID)
        var transactionType = $(this).data('transaction-type');
        var date = $(this).data('date');
        var landOwner = $(this).data('land-owner');
        var type = $(this).data('type');
        var chequeNumber = $(this).data('cheque-number');
        var amount = $(this).data('amount');
        var serialNumber = $(this).data('serial-number');
        var remarks = $(this).data('remarks');
        var recordID = $(this).data('record-id');
        $("#exampleModal1 #editProjectName").val(projectID).change();
        
        if(transactionType == "DEPOSIT") {
          $("#exampleModal1 #editTransactionTypeDeposit").prop("checked", true);
          $("#editLandOwnerDiv").addClass("visually-hidden");
          $("#editChequeNumberDiv").addClass("visually-hidden");
          $("#editSerialNumberDiv").addClass("visually-hidden");
          $("#editRemarksDiv").addClass("visually-hidden");
          $("#editLandOwner").val("");
          $("#editChequeNumber").val("");
          $("#editSerialNumber").val("");
          $("#editRemarks").val("");
        } else {
          $("#exampleModal1 #editTransactionTypeDisbursal").prop("checked", true);
          $("#editLandOwnerDiv").removeClass("visually-hidden");
          $("#editChequeNumberDiv").removeClass("visually-hidden");
          $("#editSerialNumberDiv").removeClass("visually-hidden");
          $("#editRemarksDiv").removeClass("visually-hidden");
          $("#exampleModal1 #editLandOwner").val(landOwner);
          $("#exampleModal1 #editChequeNumber").val(chequeNumber);
          $("#exampleModal1 #editSerialNumber").val(serialNumber);
          $("#exampleModal1 #editRemarks").val(remarks);
        }
        $("#exampleModal1 #editDate").val(date);
        if(type == "Land") {
          $("#exampleModal1 #editTypeLand").prop("checked", true);
        } else {
          $("#exampleModal1 #editTypeCrop").prop("checked", true);
        }
        $("#exampleModal1 #editAmount").val(amount);
        $("#exampleModal1 #recordID").val(recordID);
      });

      $(document).on("click", ".delete-record-btn", function () {
        var recordID = $(this).data('record-id');
        $("#exampleModal2 #recordID").val(recordID);
      });

      $('#filterProjectName').on('change', function() {
        var projectID = this.value;
        if(projectID != "ALL") {
          fetch("/getVillagesOfProject/"+projectID).then(response => {
            return response.json();
          }).then(data => {
            htmlData = "<option value='ALL'>ALL</option>";
            for (var i = 0; i < data.villages_count; i++) {
              htmlData += "<option value="+data.villages_output[i].villageID+">"+data.villages_output[i].villageName+"</option>";
            }
            $("#filterVillageName").html( htmlData );
          }).catch(err => {
            alert( "Error." );
          });
        } else {
          htmlData = "<option value='ALL'>ALL</option>";
          $("#filterVillageName").html( htmlData );
        }
      });

      document.addEventListener("wheel", function(event){
          if(document.activeElement.type === "number"){
              document.activeElement.blur();
          }
      });
      
      $('#chequeNumber').on('input',function(e){
        var chequeNumber = this.value;
        if(chequeNumber != "") {
        fetch("/isChequeNumberExists/"+chequeNumber).then(response => {
            return response.json();
          }).then(data => {
            if(data.isChequeNumberExists == "Y") {
              $("#validationChequeNumberFeedback").removeClass("visually-hidden");
              $("#chequeNumber").addClass("is-invalid");
            } else {
              $("#validationChequeNumberFeedback").addClass("visually-hidden");
              $("#chequeNumber").removeClass("is-invalid");
            }
          }).catch(err => {
            alert( "Error." );
          });
        }
      });
    </script>
  </body>
</html>